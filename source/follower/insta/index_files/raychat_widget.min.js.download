io.socket.transports=["websocket"];var raychat_local_storage={raychat:{},init:function(){localStorage.getItem("www.raychat.io")?this.raychat=JSON.parse(localStorage.getItem("www.raychat.io")):(localStorage.setItem("www.raychat.io",JSON.stringify({})),localStorage.getItem("rayToken")&&this.setItem("rayToken",localStorage.getItem("rayToken")))},getItem:function(e){return this.raychat[e]},setItem:function(e,a){this.raychat[e]=a,this.update()},update:function(){return localStorage.setItem("www.raychat.io",JSON.stringify(this.raychat))},getObject:function(){return this.raychat},remove:function(e){delete this.raychat[e],this.update()},removeAll:function(){this.raychat={},this.update()}};raychat_local_storage.init(),raychat_local_storage.setItem("raychat_channel_photo",JSON.parse(document.getElementById("raychat_scripts").getAttribute("widget")).channelPhoto);var widget=JSON.parse(document.getElementById("raychat_scripts").getAttribute("widget"));io.socket.on("disconnect",function(){document.getElementById("raychat_main_textarea").disabled=!0,document.getElementById("raychat_main_textarea").placeholder=widget.lang.disconnectedFromServer,raychat_avoid_sending(!0)});var checkUserInterval,tryConnect=0,visitorDetailsComplete=!1,checkForVisitorDetails=function(){if(visitorDetailsComplete){if(raychat_local_storage.getItem("rayToken")){var e={user:{id:raychat_local_storage.getItem("rayToken"),name:raychat_local_storage.getItem("clientName"),agent:raychat_local_storage.getItem("agent"),chatCount:raychat_local_storage.getItem("chatCount"),href:window.location.href,channelId:widget.channel.id,containerId:widget.container.id}};io.socket.post(webAppUrl+"/socket/onlyAddToRoom",e,function(e,a){})}clearInterval(checkUserInterval)}};io.socket.on("connect",function(){checkUserInterval=setInterval(function(){checkForVisitorDetails()},2e3),isUserLock?(raychat_avoid_sending(!0),document.getElementById("raychat_main_textarea").disabled=!0,document.getElementById("raychat_main_textarea").placeholder=widget.lang.pleaseFillForm,document.getElementById("raychat_main_textarea").className+=" force_for_fill_form"):0===tryConnect?(raychat_avoid_sending(!0),document.getElementById("raychat_main_textarea").disabled=!0,document.getElementById("raychat_main_textarea").placeholder=widget.lang.fetchingYourConversation):(raychat_avoid_sending(!1),document.getElementById("raychat_main_textarea").disabled=!1,document.getElementById("raychat_main_textarea").placeholder=widget.lang.sendMessage),tryConnect++});var nameOffset,verOffset,ix,nVer=navigator.appVersion,nAgt=navigator.userAgent,browserName=navigator.appName,fullVersion=""+parseFloat(navigator.appVersion),majorVersion=parseInt(navigator.appVersion,10);function detectmob(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}-1!=(verOffset=nAgt.indexOf("Opera"))?(browserName="Opera",fullVersion=nAgt.substring(verOffset+6),-1!=(verOffset=nAgt.indexOf("Version"))&&(fullVersion=nAgt.substring(verOffset+8))):-1!=(verOffset=nAgt.indexOf("MSIE"))?(browserName="Microsoft Internet Explorer",fullVersion=nAgt.substring(verOffset+5)):-1!=(verOffset=nAgt.indexOf("Chrome"))?(browserName="Chrome",fullVersion=nAgt.substring(verOffset+7)):-1!=(verOffset=nAgt.indexOf("Safari"))?(browserName="Safari",fullVersion=nAgt.substring(verOffset+7),-1!=(verOffset=nAgt.indexOf("Version"))&&(fullVersion=nAgt.substring(verOffset+8))):-1!=(verOffset=nAgt.indexOf("Firefox"))?(browserName="Firefox",fullVersion=nAgt.substring(verOffset+8)):(nameOffset=nAgt.lastIndexOf(" ")+1)<(verOffset=nAgt.lastIndexOf("/"))&&(browserName=nAgt.substring(nameOffset,verOffset),fullVersion=nAgt.substring(verOffset+1),browserName.toLowerCase()==browserName.toUpperCase()&&(browserName=navigator.appName)),-1!=(ix=fullVersion.indexOf(";"))&&(fullVersion=fullVersion.substring(0,ix)),-1!=(ix=fullVersion.indexOf(" "))&&(fullVersion=fullVersion.substring(0,ix)),majorVersion=parseInt(""+fullVersion,10),isNaN(majorVersion)&&(fullVersion=""+parseFloat(navigator.appVersion),majorVersion=parseInt(navigator.appVersion,10));var OSName="Unknown OS";-1!=navigator.appVersion.indexOf("Win")&&(OSName="Windows"),-1!=navigator.appVersion.indexOf("Mac")&&(OSName="MacOS"),-1!=navigator.appVersion.indexOf("X11")&&(OSName="UNIX"),-1!=navigator.appVersion.indexOf("Linux")&&(OSName="Linux");var opened=!1,openedEmoji=!1,isUserLock=!1,allowForScrollToFetchMore=!1,totalChatCount=0,renderedChatCount=0,renderedPage=1,q=document.getElementById("raychat_main_container_footer_details_div_emoji_div"),d=document.getElementById("raychatMainContainer"),b=document.getElementById("raychat_main_button_id"),f=document.getElementById("raychat_main_container_footer"),i=document.getElementById("raychat_main_textarea"),h=document.getElementById("raychat_main_container_footer_details_div_send"),s=document.getElementById("raychat_main_container_body"),c=document.getElementById("raychat_main_button_count"),u=document.getElementById("raychat_main_button_count_s"),a=document.getElementById("raychat_main_container_body_chat_item_toast_message"),o=document.getElementById("raychat_main_container_header_agents_accepted"),l=document.getElementById("raychat_main_container_header_agents"),x=document.getElementById("raychat_main_container_header_agents_accepted"),w=document.getElementById("raychage_file_upload"),m=document.getElementById("raychat_main_spinner"),t=document.getElementById("raychat_main_container_body_chat_item_typing"),g=document.getElementById("raychat_user_more_details_response_phone"),uu=document.getElementById("raychat_main_container_header_agents_close_btnId"),uu2=document.getElementById("raychat_main_container_header_agents_close_btnId2"),rr=document.getElementById("raychat_accepted_user_title"),ww=document.getElementById("raychat_main_container_body_watermark"),webAppUrl=document.getElementById("raychat_scripts").getAttribute("webAppUrl"),cdnUrl=document.getElementById("raychat_scripts").getAttribute("cdnUrl")+"/",raychat_pending_for_automessage=!0,raychat_submit_sound=document.createElement("audio");raychat_submit_sound.setAttribute("src",webAppUrl+"/widget/audio/submit.9b6dc5c5.mp3");var raychat_delivered_sound=document.createElement("audio");raychat_delivered_sound.setAttribute("src",webAppUrl+"/widget/audio/delivered.240b316e.mp3");var raychat_new_message_sound=document.createElement("audio");raychat_new_message_sound.src=webAppUrl+"/widget/audio/notification.0d062b33.mp3";var raychat_tmp_file_size,n,oldTitle=window.parent.document.title,counter=0;Element.prototype.remove=function(){this.parentElement.removeChild(this)},NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=this.length-1;0<=e;e--)this[e]&&this[e].parentElement&&this[e].parentElement.removeChild(this[e])};var tdata={token:document.getElementById("raychat_scripts").getAttribute("token")};function raychat_responsive_in_iphone(){detectmob()&&"iPhone"==navigator.platform&&(568==screen.height?s.style.height="55px":667==screen.height?s.style.height="205px":(console.log(screen.height),s.style.height="226px"))}function raychat_floating_app_widget_init(_){parent.raychat_check_for_load(),raychat_logo_manager(),i.addEventListener("focus",function(e){f.className+=" active",raychat_responsive_in_iphone()}),i.addEventListener("focusout",function(e){f.classList.remove("active"),"iPhone"==navigator.platform&&detectmob()&&(s.style.height=parent.window.innerHeight-139+"px")}),i.addEventListener("input",function(e){tdata.msg=e.currentTarget.value,tdata.agentId=raychat_local_storage.getItem("raychat_agent_id"),tdata.conversationId=raychat_local_storage.getItem("raychat_conversationId"),0!==e.currentTarget.value.length&&e.currentTarget.value.trim()?h.className.match(/\bactive\b/)||(h.className+=" active",h.getElementsByClassName("custom-file-upload")[0].classList.remove("active"),h.getElementsByClassName("custom-file-upload")[0].style.display="none"):(h.classList.remove("active"),h.getElementsByClassName("custom-file-upload")[0].className+=" active",h.getElementsByClassName("custom-file-upload")[0].style.display="inline-block")}),i.addEventListener("keydown",function(e){if(e.ctrlKey&&(13==e.keyCode||13==e.which))return e.currentTarget.value+="\n",!1;13!=e.which&&13!=e.keyCode||(snd(e.currentTarget.value.replace(/\r?\n/g,"<br>"),!1),h.classList.remove("active"),h.getElementsByClassName("custom-file-upload")[0].className+=" active",h.getElementsByClassName("custom-file-upload")[0].style.display="inline-block",e.currentTarget.value="",e.preventDefault())}),d.addEventListener("click",function(e){}),s.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),s.addEventListener("dragleave",function(e){e.preventDefault(),e.stopPropagation()}),s.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation();var a=e.dataTransfer.files[0];r(a)&&raychat_open_verify(a)}),i.addEventListener("dragover",function(e){e.preventDefault(),e.stopPropagation()}),i.addEventListener("dragleave",function(e){e.preventDefault(),e.stopPropagation()}),i.addEventListener("drop",function(e){e.preventDefault(),e.stopPropagation();var a=e.dataTransfer.files[0];r(a)&&raychat_open_verify(a)});s.scrollHeight;s.addEventListener("scroll",function(e){allowForScrollToFetchMore&&0==s.scrollTop&&(tdata.page=renderedPage,io.socket.get(webAppUrl+"/chats/getMore",tdata,function(e,a){var t=document.getElementsByClassName("raychat_main_container_body_chat_item")[0];if(renderedChatCount+=e.chats.length,0<e.chats.length){for(var n=0;n<e.chats.length;n++)e.chats[n].meta.userId===tdata.id?(e.chats[n].me=!0,appendMsg(e.chats[n].message,e.chats[n],t)):(e.chats[n].me=!1,appendMsgAgent(e.chats[n].message,e.chats[n].meta.user_avatar,e.chats[n].meta.userId,e.chats[n].id,null,e.chats[n],t));renderedPage++}else allowForScrollToFetchMore=!1}))}),document.onkeydown=function(e){("key"in(e=e||window.event)?"Escape"===e.key||"Esc"===e.key:27===e.keyCode)&&raychat_escape_button_clicked()},parent.onkeydown=function(e){("key"in(e=e||window.event)?"Escape"==e.key||"Esc"==e.key:27==e.keyCode)&&raychat_escape_button_clicked()},document.onpaste=function(e){for(var a=(e.clipboardData||e.originalEvent.clipboardData).items,t=0;t<a.length;t++){var n=a[t];if("file"===n.kind&&raychat_tmp_file_size!=n.getAsFile().size){var _=n.getAsFile();r(_)&&raychat_open_verify(_),raychat_tmp_file_size=n.getAsFile().size}}};var a;function o(e,a){var t="";t="email"===e.form.fieldName?'<div class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated raychat_main_container_body_chat_item_inputs"> <div class="raychat_main_container_body_chat_item_avatar" id="raychat_main_container_body_chat_item_avatar_email_tel"></div><div class="raychat_main_container_body_chat_item_message_agent raychat_main_container_body_chat_item_message_agent_email_phone_form"> <h4 class="raychat_main_container_body_chat_item_message_agent_email_phone_form_heading">'+widget.lang.be_notified+'</h4> <div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_tab"> <ul class="raychat_noselect"> <li id="raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_email" class="active">'+widget.lang.email+'</li></ul> </div><div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_body"> <div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_div active" id="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email"> <input type="email" placeholder="'+widget.lang.enter_your_email+'" class="raychat_animated fadeIn" id="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val"> <button class="raychat_animated fadeIn" onclick="raychat_send_email_add(this)">'+widget.lang.submit+'</button> <div class="raychat_user_more_details_response success raychat_noselect" id="raychat_user_more_details_response_email"></div></div></div></div></div>':"phone"===e.form.fieldName?'<div class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated raychat_main_container_body_chat_item_inputs"> <div class="raychat_main_container_body_chat_item_avatar" id="raychat_main_container_body_chat_item_avatar_email_tel"></div><div class="raychat_main_container_body_chat_item_message_agent raychat_main_container_body_chat_item_message_agent_email_phone_form"> <h4 class="raychat_main_container_body_chat_item_message_agent_email_phone_form_heading">'+widget.lang.be_notified+'</h4> <div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_tab"> <ul class="raychat_noselect"> <li id="raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_phone" class="active">'+widget.lang.phone_number+'</li></ul> </div><div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_body"> <div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_div active" id="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_tel"> <input type="tel" placeholder="'+widget.lang.enter_your_phone_number+'" class="raychat_animated fadeIn" id="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val"> <button class="raychat_animated fadeIn" onclick="raychat_send_email_add(this)">'+widget.lang.submit+'</button> <div class="raychat_user_more_details_response success raychat_noselect" id="raychat_user_more_details_response_phone"></div></div></div></div></div>':'<div class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated raychat_main_container_body_chat_item_inputs"> <div class="raychat_main_container_body_chat_item_avatar" id="raychat_main_container_body_chat_item_avatar_email_tel"></div><div class="raychat_main_container_body_chat_item_message_agent raychat_main_container_body_chat_item_message_agent_email_phone_form"> <h4 class="raychat_main_container_body_chat_item_message_agent_email_phone_form_heading">'+widget.lang.be_notified+'</h4> <div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_tab"> <ul class="raychat_noselect"> <li id="raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_email" class="active">'+widget.lang.email+'</li><li id="raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_phone">'+widget.lang.phone_number+'</li></ul> </div><div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_body"> <div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_div active" id="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email"> <input type="email" placeholder="'+widget.lang.enter_your_email+'" class="raychat_animated fadeIn" id="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val"> <button class="raychat_animated fadeIn" onclick="raychat_send_email_add(this)">'+widget.lang.submit+'</button> <div class="raychat_user_more_details_response success raychat_noselect" id="raychat_user_more_details_response_email"></div></div><div class="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_div" id="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_tel"> <input type="tel" placeholder="'+widget.lang.enter_your_phone_number+'" class="raychat_animated fadeIn" id="raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val"> <button class="raychat_animated fadeIn" onclick="raychat_send_email_add(this)">'+widget.lang.submit+'</button> <div class="raychat_user_more_details_response success raychat_noselect" id="raychat_user_more_details_response_phone"></div></div></div></div></div>',document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",t);var n,_=0;raychat_local_storage.getItem("raychat_agent_avatar")?(n="url('"+webAppUrl+raychat_local_storage.getItem("raychat_agent_avatar")+"');",_++):"undefined"!==document.getElementById("raychat_scripts").getAttribute("raychat_onlineAgents")&&""!==document.getElementById("raychat_scripts").getAttribute("raychat_onlineAgents")&&(n="url('"+webAppUrl+document.getElementById("raychat_scripts").getAttribute("raychat_onlineAgents")+"')",_++),0===_&&(n="url('"+webAppUrl+"/"+raychat_local_storage.getItem("raychat_channel_photo")+"')"),document.getElementById("raychat_main_container_body_chat_item_avatar_email_tel")&&(document.getElementById("raychat_main_container_body_chat_item_avatar_email_tel").style.backgroundImage=n),a&&(a.email&&-1===a.email.search("@raychat.ir")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val")&&(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").value=a.email),a.phone&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val")&&(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").value=a.phone)),document.getElementsByClassName("raychat_main_container_body_chat_item_inputs")[0]&&(document.getElementsByClassName("raychat_main_container_body_chat_item_inputs")[0].style.display="block"),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_phone")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_phone").addEventListener("click",function(e){e.currentTarget.className.match(/\bactive\b/)||(e.currentTarget.className+=" active"),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_email").classList.remove("active"),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_tel").className.match(/\bactive\b/)||(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_tel").className+=" active"),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email").classList.remove("active")}),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_email")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_email").addEventListener("click",function(e){e.currentTarget.className.match(/\bactive\b/)||(e.currentTarget.className+=" active"),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_phone").classList.remove("active"),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email").className.match(/\bactive\b/)||(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email").className+=" active"),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_tel").classList.remove("active")}),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").addEventListener("keydown",function(e){13!==e.which&&13!==e.keyCode||raychat_send_email_add(e.currentTarget)}),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").addEventListener("keydown",function(e){13!==e.which&&13!==e.keyCode||raychat_send_email_add(e.currentTarget)}),JSON.parse(e.form.forceGetUserDetails)&&function(e,a){var t,n;["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].some(function(e){return"function"==typeof document.body[e]&&(t=e,!0)});for(;e;){if((n=e.parentElement)&&n[t](a))return n;e=n}return null}(document.getElementById("raychat_main_textarea"),".raychat_main_container_footer").addEventListener("click",scroll_to_form,!0),scrollTo(s,s.scrollHeight,200)}function r(e){var a;return!!e&&(e.size>widget.container.uploadLimit?(a='<div class="raychat_main_container_body_chat_item_toast_message warning raychat_zoomIn raychat_animated active raychat_noselect" id="raychat_main_container_body_chat_item_toast_message">'+widget.lang.largeFile+"</div>",document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",a),scrollTo(s,s.scrollHeight,200),!1):-1!=["text/csv","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","image/gif","image/jpeg","application/pdf","application/vnd.ms-powerpoint","image/svg+xml","application/x-tar","image/webp","application/zip","application/x-zip-compressed","application/vnd.ms-excel","video/mpeg","application/x-rar-compressed","application/rtf","audio/ogg","audio/mp3","video/ogg","image/png","application/vnd.ms-powerpoint","application/x-7z-compressed","video/3gpp","video/mp4","video/mpeg","video/quicktime","video/webm","video/x-ms-wmv","video/x-msvideo","audio/mpeg","audio/x-m4a"].indexOf(e.type)||(a='<div class="raychat_main_container_body_chat_item_toast_message warning raychat_zoomIn raychat_animated active raychat_noselect" id="raychat_main_container_body_chat_item_toast_message">'+widget.lang.invalidFormat+"</div>",document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",a),scrollTo(s,s.scrollHeight,200),!1))}setInterval(function(){0},998),tdata.browser={name:browserName,ver:fullVersion,os:OSName,mobile:detectmob()},parent&&parent.document&&parent.document.referrer&&(tdata.browser.referrer=parent.document.referrer),raychat_avoid_sending(!0),_&&(document.getElementById("raychat_main_container_body_chat").innerHTML="",_.load&&(tdata.id=_.userId)),tdata.channelId=widget.channel.id,tdata.containerId=widget.container.id,tdata.agents=widget.agents,io.socket.get(webAppUrl+"/newvisitor",tdata,function(e,a){if(e.success){if(e.openConversation)if(raychat_local_storage.getItem("raychat_agent_id"))raychat_agent_accept({name:raychat_local_storage.getItem("raychat_agent_name"),id:raychat_local_storage.getItem("raychat_agent_id"),avatar:raychat_local_storage.getItem("raychat_agent_avatar"),title:raychat_local_storage.getItem("raychat_agent_title"),conversationId:raychat_local_storage.getItem("raychat_conversationId")});else raychat_local_storage.setItem("raychat_agent_id",e.openConversationAgentId),raychat_getAgents();else raychat_conversationClosed(!0);if(isUserLock=e.lockForFillDetails&&(widget.channel.notOfficeHours.offlineMessage.active||widget.channel.sendForm.active),raychat_local_storage.setItem("clientName",e.name),raychat_local_storage.setItem("chatCount",e.chatCount),raychat_local_storage.setItem("agent",e.agent),!raychat_local_storage.getItem("rayToken")){var t={user:{id:e.id,name:raychat_local_storage.getItem("clientName"),agent:raychat_local_storage.getItem("agent"),chatCount:raychat_local_storage.getItem("chatCount"),href:window.location.href,channelId:widget.channel.id,containerId:widget.container.id}};io.socket.post(webAppUrl+"/socket/onlyAddToRoom",t,function(e,a){})}if(raychat_local_storage.setItem("rayToken",e.id),localStorage.setItem("rayToken",e.id),raychat_toggle_spinner(!(visitorDetailsComplete=!0)),detectmob()||document.getElementById("raychat_main_textarea").focus(),totalChatCount=e.chatCount||0,e.conversation&&(renderedChatCount=e.conversation.chats.length,0<e.conversation.chats.length)){renderedChatCount<=totalChatCount&&(allowForScrollToFetchMore=!0),raychat_pending_for_automessage=!1,e.conversation.chats=e.conversation.chats.reverse();for(var n=0;n<e.conversation.chats.length;n++)e.conversation.chats[n].meta.userId===e.id?(e.conversation.chats[n].me=!0,appendMsg(e.conversation.chats[n].message,e.conversation.chats[n])):(e.conversation.chats[n].me=!1,appendMsgAgent(e.conversation.chats[n].message,e.conversation.chats[n].meta.user_avatar,e.conversation.chats[n].meta.userId,e.conversation.chats[n].id,null,e.conversation.chats[n]))}e.lockForFillDetails&&widget.channel.notOfficeHours.offlineMessage.form.forceGetUserDetails&&widget.channel.notOfficeHours.offlineMessage.active?(widget.channel.notOfficeHours.offlineMessage.form.forceGetUserDetails&&(raychat_avoid_sending(!0),document.getElementById("raychat_main_textarea").disabled=!0,document.getElementById("raychat_main_textarea").placeholder=widget.lang.pleaseFillForm,document.getElementById("raychat_main_textarea").className+=" force_for_fill_form"),o(widget.channel.notOfficeHours.offlineMessage,{email:e.email||"",phone:e.phone||""})):e.lockForFillDetails&&widget.channel.sendForm.form.forceGetUserDetails&&widget.channel.sendForm.active?(widget.channel.sendForm.form.forceGetUserDetails&&(raychat_avoid_sending(!0),document.getElementById("raychat_main_textarea").disabled=!0,document.getElementById("raychat_main_textarea").placeholder=widget.lang.pleaseFillForm,document.getElementById("raychat_main_textarea").className+=" force_for_fill_form"),o(widget.channel.sendForm,{email:e.email||"",phone:e.phone||""})):(document.getElementById("raychat_main_textarea").disabled=!1,document.getElementById("raychat_main_textarea").placeholder=widget.lang.sendMessage,raychat_avoid_sending(!1)),parent.Raychat.__profile_updated(e),_?parent.Raychat.load(_):parent.Raychat.load()}else raychat_toggle_spinner(!1),document.getElementById("raychat_main_textarea").placeholder=widget.lang.forConnectingAgainPleaseRefreashYourBrowser,raychat_local_storage.removeAll(),document.getElementById("raychat_main_textarea").disabled=!0,io.socket.disconnect()}),io.socket.on("raychat_newMessage",function(e){var a;appendMsgAgent(e.message,e.agent_avatar,e.agent_id,e.chatId,!0,e.messageObj,!1),raychat_new_message_notification(),a=raychat_local_storage.getItem("raychat_agent_avatar")?webAppUrl+"/"+raychat_local_storage.getItem("raychat_agent_avatar"):webAppUrl+"/"+raychat_local_storage.getItem("raychat_channel_photo"),e.messageObj&&0==e.messageObj.type?parent.raychat_set_automessage_preview(widget.lang.photoMessage,raychat_local_storage.getItem("raychat_agent_name"),a):e.messageObj&&1==e.messageObj.type?parent.raychat_set_automessage_preview(widget.lang.videoMessage,raychat_local_storage.getItem("raychat_agent_name"),a):e.messageObj&&2==e.messageObj.type?parent.raychat_set_automessage_preview(widget.lang.musicMessage,raychat_local_storage.getItem("raychat_agent_name"),a):e.messageObj&&3==e.messageObj.type||4==e.messageObj.type?parent.raychat_set_automessage_preview(widget.lang.fileMessage,raychat_local_storage.getItem("raychat_agent_name"),a):"00raychat:data:image0"==e.message.substr(0,21)?parent.raychat_set_automessage_preview(widget.lang.photoMessage,raychat_local_storage.getItem("raychat_agent_name"),a):parent.raychat_set_automessage_preview(e.message,raychat_local_storage.getItem("raychat_agent_name"),a)}),io.socket.on("conversationClosed",function(e){raychat_conversationClosed()}),io.socket.on("showFormAndMessage",function(e){offlineMessageSetting=e.offlineMessage,JSON.parse(e.offlineMessage.form.forceGetUserDetails)&&(raychat_avoid_sending(!0),document.getElementById("raychat_main_textarea").disabled=!0,document.getElementById("raychat_main_textarea").placeholder=widget.lang.pleaseFillForm,document.getElementById("raychat_main_textarea").className+=" force_for_fill_form"),o(e.offlineMessage,{email:e.email,phone:e.phone}),JSON.parse(e.offlineMessage.offlineMessage.active)&&appendMsgAgent(e.offlineMessage.offlineMessage.message)}),io.socket.on("refreshBrowser",function(e){confirm(widget.lang.allowReloadPage)&&parent.location.reload()}),io.socket.on("sendXYtoMe",function(_){parent.document.onmousemove=function(e){var a,t,n;null==(e=parent.event||e).pageX&&null!=e.clientX&&(a=e.target&&e.target.ownerDocument||document,t=a.documentElement,n=a.body,e.pageX=e.clientX+(t&&t.scrollLeft||n&&n.scrollLeft||0)-(t&&t.clientLeft||n&&n.clientLeft||0),e.pageY=e.clientY+(t&&t.scrollTop||n&&n.scrollTop||0)-(t&&t.clientTop||n&&n.clientTop||0)),console.log(e.pageX),console.log(e.pageY),io.socket.post(webAppUrl+"/realTimeBrowser",{agentId:_.agentId,x:e.pageX,y:e.pageY},function(e,a){})}}),io.socket.on("acceptedChat",function(e){raychat_agent_accept(e)}),io.socket.on("raychat_start_chat_with_agent",function(e){raychat_agent_accept(e)}),io.socket.on("chatTransfered",function(e){raychat_agent_transfer(e)}),io.socket.on("rayachat_userIsBanned",function(e){document.getElementById("raychatMainContainer").remove(),window.parent.document.getElementById("raychatBtn").remove(),window.parent.document.getElementById("raychat_automessage_preview_container").remove()}),io.socket.on("typing",function(e){e.typing?(document.getElementById("raychat_agent_heading_typing").className+=" active",clearTimeout(a),a=setTimeout(function(){document.getElementById("raychat_agent_heading_typing").classList.remove("active")},5e4)):(clearTimeout(a),document.getElementById("raychat_agent_heading_typing").classList.remove("active"))}),h.addEventListener("click",function(e){e.currentTarget.getElementsByClassName("custom-file-upload")[0].classList.contains("active")||(snd(i.value,!1),h.classList.remove("active"),h.getElementsByClassName("custom-file-upload")[0].className+=" active",h.getElementsByClassName("custom-file-upload")[0].style.display="inline-block",i.value="",i.focus())}),XMLHttpRequest.prototype.sendAsBinary||(XMLHttpRequest.prototype.sendAsBinary=function(e){var a=Array.prototype.map.call(e,function(e){return 255&e.charCodeAt(0)}),t=new Uint8Array(a);this.send(t.buffer)}),w.addEventListener("change",function(e){var a=e.currentTarget.files[0];r(a)&&raychat_open_verify(a)}),raychat_check_responsive(),parent.window.onresize=function(){raychat_check_responsive()}}function raychat_new_message_notification(){if(raychat_new_message_sound){var e=raychat_new_message_sound.play();void 0!==e&&e.catch(function(e){console.warn("playing notification sound rejected by user browser. see more: https://goo.gl/xX8pDD")})}window.parent.document.title=widget.lang.newMessage,setTimeout(function(){window.parent.document.title=oldTitle},2e3),parent.raychat_setCounterOn(++counter)}function raychat_logo_manager(){JSON.parse(document.getElementById("raychat_scripts").getAttribute("widget")).hideRaychatLogo&&ww.classList.remove("active")}function raychat_escape_button_clicked(){window.parent.document.getElementById("raychat_open_modal")&&window.parent.document.getElementById("raychat_open_modal").classList.contains("active")?window.parent.document.getElementById("raychat_open_modal").click():openedEmoji?document.getElementsByClassName("raychat_main_container_footer_details_div_emoji")[0].click():opened?parent.raychat_close_container():window.parent.document.getElementById("raychat_automessage_preview_container")&&window.parent.document.getElementById("raychat_automessage_preview_container").classList.contains("active")&&parent.raychat_close_automessage_preview()}function raychatBtnClicked(){opened?(d.className+=" fadeOut raychat_animated",d.classList.remove("active"),d.classList.remove("raychat_animated"),b.classList.remove("active"),opened=!1):(d.classList.remove("active"),d.className+=" active",b.className+=" active",detectmob()||document.getElementById("raychat_main_textarea").focus(),scrollTo(s,s.scrollHeight,200),opened=!0),raychat_check_responsive()}function raychat_check_responsive(){parent.window.innerHeight<640?(d.classList.contains("responsive")||(d.className+=" responsive",uu.className+=" active",uu2.className+=" active"),opened?(detectmob()&&(parent.window.document.body.className+=" raychat_no_overflow"),window.parent.document.getElementById("raychatBtn").style.display=" none"):detectmob()&&parent.window.document.body.classList.remove("raychat_no_overflow"),s.style.height=parent.window.innerHeight-139+"px"):(s.style.height="73%",uu.classList.remove("active"),uu2.classList.remove("active"),d.classList.remove("responsive"),opened&&(window.parent.document.getElementById("raychatBtn").style.display=" block"),parent.window.document.body.classList.remove("raychat_no_overflow")),opened||(window.parent.document.getElementById("raychatBtn").style.display=" block")}function raychat_avoid_sending(e){var a=document.getElementsByClassName("raychat_main_container_footer_details_div_emoji")[0],t=document.getElementsByClassName("custom-file-upload")[0];e?(a.style.display="none",t.style.display="none"):(a.style.display="inline-block",t.style.display="inline-block")}function raycaht_shuffle_array(e){for(var a,t,n=e.length;0!==n;)t=Math.floor(Math.random()*n),a=e[n-=1],e[n]=e[t],e[t]=a;return e}function raychat_getAgents(){io.socket.get(webAppUrl+"/floatChat/getAgents",tdata,function(e,a){var t,n=1;if(e.length<=0)return!1;var _=[];_=e=raycaht_shuffle_array(e);for(var i=0;i<e.length;i++)e[i].online&&2!=i&&_.move(i,2);e=_,_=[];for(var o=0;o<e.length;o++){if(raychat_local_storage.getItem("raychat_agent_id"))if(raychat_local_storage.getItem("raychat_agent_id")===e[o].id)return raychat_agent_accept({name:e[o].name,id:e[o].id,avatar:e[o].avatar,title:e[o].title,conversationId:raychat_local_storage.getItem("raychat_conversationId")}),!1;if(3<n)break;t=e[o].online?'<div class="raychat_main_container_header_agents_'+n+' raychat_main_container_header_agents_agent fadeInRight raychat_main_container_header_agents_agent_border raychat_animated" style="background-image: url('+webAppUrl+e[o].avatar+');"><span class="raychat_zoomIn raychat_animated raychat_main_container_header_agents_agent_status online"></span></div>':'<div class="raychat_main_container_header_agents_'+n+' raychat_main_container_header_agents_agent fadeInRight raychat_main_container_header_agents_agent_border raychat_animated" style="background-image: url('+webAppUrl+e[o].avatar+');"><span class="raychat_main_container_header_agents_agent_status offline"></span></div>',n++,document.getElementById("raychat_main_container_header_agents_list").insertAdjacentHTML("beforeend",t)}var r=document.getElementsByClassName("raychat_main_container_header_agents_heading")[0].getElementsByTagName("h3")[0],c=document.getElementsByClassName("raychat_main_container_header_agents_heading")[0].getElementsByTagName("p")[0];2===n?(r.style[widget.lang.align]="93px",c.style[widget.lang.align]="93px"):3===n&&(r.style[widget.lang.align]="116px",c.style[widget.lang.align]="116px")})}function raychat_strip_tags(e,a,t){for(var n=[],_="",i=1;i<arguments.length;i++)_=arguments[i].replace(/<|>/g,"").trim(),0<arguments[i].length&&n.push(_,"../"+_);if("string"==typeof e||e instanceof String){if(0==n.length)return e.replace(/<(\s*\/?)[^>]+>/g,"");var o=new RegExp("<(?!("+n.join("|")+")s*/?)[^>]+>","g");return e.replace(o,"")}return""}function raychat_linkify(e){var a,t,n;return a=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,t=/(^|[^\/])(www\.[\S]+(\b|$))/gim,n=/(([a-zA-Z0-9\-\_\.])+@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim,e.replace(a,'<a href="$1" class="raychat_message_href" target="_blank">$1</a>').replace(t,'$1<a href="../../$2" class="raychat_message_href" target="_blank">$2</a>').replace(n,'<a href="mailto:$1" class="raychat_message_href">$1</a>')}function raychat_htmlEntities(e){return raychat_strip_tags(raychat_linkify(e),"br","a")}function raychat_find_urls(e){return e.match(/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi)}function raychat_extract_hostname(e){return(-1<e.indexOf("://")?e.split("/")[2]:e.split("/")[0]).split(":")[0].split("?")[0]}function raychat_concat_protocol_to_url(e){return-1==e.indexOf("://")?"http://"+e:e}function raychat_get_url_preview(t,n,e,a){if(a)return a.targetChat=e,a.mainUrl=t,void raychat_get_url_preview_html(a);var _={url:t,token:tdata.token,chatId:e};io.socket.post(webAppUrl+"/linkPreview",_,function(e,a){200==a.statusCode&&document.getElementById(n)&&document.getElementById(n).getElementsByClassName("raychat_link_preview")[0]&&(e.mainUrl=t,e.targetChat=n,raychat_get_url_preview_html(e))})}function raychat_get_url_preview_html(e){var a;if(e.image){var t=new Image;t.onload=function(){a='<div class="raychat_link_preview_thumnail"><img src="'+e.image+'"></div><div class="raychat_link_preview_content"><h4>'+e.title+"</h4><p>"+e.description+'</p><span><a target="_blank" href="'+e.mainUrl+'" title="'+e.mainUrl+'">'+raychat_extract_hostname(e.mainUrl)+"</a></span></div>",document.getElementById(e.targetChat).getElementsByClassName("raychat_link_preview")[0].innerHTML=a},t.onerror=function(){a='<div class="raychat_link_preview_content" style="width: 100% !important; padding-right: 4px;"><h4 style="text-align: center">'+e.title+'</h4><p style="text-align: center">'+e.description+'</p><span><a target="_blank" href="'+e.mainUrl+'" title="'+e.mainUrl+'">'+raychat_extract_hostname(e.mainUrl)+"</a></span></div>",document.getElementById(e.targetChat).getElementsByClassName("raychat_link_preview")[0].innerHTML=a},t.src=e.image}else a='<div class="raychat_link_preview_content" style="width: 100% !important; padding-right: 4px;"><h4 style="text-align: center">'+e.title+'</h4><p style="text-align: center">'+e.description+'</p><span><a target="_blank" href="'+e.mainUrl+'" title="'+e.mainUrl+'">'+raychat_extract_hostname(e.mainUrl)+"</a></span></div>",document.getElementById(e.targetChat).getElementsByClassName("raychat_link_preview")[0].innerHTML=a;scrollTo(s,s.scrollHeight,200)}function snd(e,a){if(0!==e.length&&e.trim()&&(a||!(3428<e.length))){raychat_submit_sound.play();var t,n,_,i=Math.random().toString(36).substring(7);a?t='<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_me_emoji raychat_noselect">'+e+'<span class="raychat_main_container_body_chat_me_emoji_status raychat_noselect">'+widget.lang.sending+"</span></div></div>":"00raychat:data:image0"==e.substr(0,21)?t='<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_message_me raychat_main_container_body_chat_item_message_me_uploaded_image"><img class="raychat_main_container_user_uploaded_pic" onclick="raychat_open_image(this)" src="'+e.substring(22,e.length)+'"/><span class="raychat_main_container_body_chat_item_message_me_uploaded_image_status raychat_noselect">'+widget.lang.sending+"</span></div></div>":raychat_find_urls(e)?(n=raychat_find_urls(e),_=raychat_concat_protocol_to_url(_=n[0]),t='<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_message_me raychat_bgc">'+raychat_htmlEntities(e)+'<div class="raychat_link_preview"><a href="'+_+'" target="_blank" title="'+_+'">'+raychat_extract_hostname(n[0])+'</a></div><span class="raychat_main_container_body_chat_item_message_me_status raychat_noselect">'+widget.lang.sending+"</span></div></div>"):t='<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_message_me raychat_bgc">'+raychat_htmlEntities(e)+'<span class="raychat_main_container_body_chat_item_message_me_status raychat_noselect">'+widget.lang.sending+"</span></div></div>",document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",t),scrollTo(s,s.scrollHeight,200),tdata.id=raychat_local_storage.getItem("rayToken"),tdata.msg=e,tdata.href=window.location.href,tdata.tmpId=i,io.socket.post(webAppUrl+"/floatChat",tdata,function(e,a){1==e.status?document.getElementById(e.tmpId).getElementsByTagName("span")[0].innerHTML=widget.lang.messageNotSend:2===e.status?document.getElementById(e.tmpId).getElementsByTagName("span")[0].innerHTML=widget.lang.formIsEmpty+widget.lang.messageNotSend:(document.getElementById(e.tmpId).getElementsByTagName("span")[0].innerHTML=widget.lang.messageSent,raychat_delivered_sound.play(),n&&_&&raychat_get_url_preview(_,i,e.chatId))})}}function sendMedia(e,a,t,n){raychat_submit_sound.play();var _={token:document.getElementById("raychat_scripts").getAttribute("token"),id:raychat_local_storage.getItem("rayToken"),msg:e,type:a,href:window.location.href,tmpId:t,moreData:n};io.socket.post(webAppUrl+"/floatChat",_,function(e,a){1==e.status?document.getElementById(e.tmpId).getElementsByClassName("raychat_main_container_body_chat_item_message_me_uploaded_image_status")[0].innerHTML=widget.lang.messageNotSend:2===e.status?document.getElementById(e.tmpId).getElementsByClassName("raychat_main_container_body_chat_item_message_me_uploaded_image_status")[0].innerHTML=widget.lang.formIsEmpty+widget.lang.messageNotSend:(document.getElementById(e.tmpId).getElementsByClassName("raychat_main_container_body_chat_item_message_me_uploaded_image_status")[0].innerHTML=n.name||"",raychat_delivered_sound.play())})}function raychat_open_image(e){var a=e.getAttribute("src"),t=parent.window.innerHeight-100,n=parent.window.pageYOffset||parent.document.documentElement.scrollTop||parent.document.body.scrollTop||0;n+=40;var _=parent.window.document.body.scrollHeight;if(window.parent.document.getElementById("raychat_open_modal"))window.parent.document.getElementById("raychat_open_modal").className+=" active",window.parent.document.getElementById("raychat_open_modal").innerHTML='<div><img class="raychat_zoomIn raychat_noselect raychat_animated-fast" src="'+a+'" style="height: '+t+"px; margin: "+n+'px 0;"></div>';else{var i='<div class="raychat_open_modal raychat_noselect active" id="raychat_open_modal"><div><img class="raychat_zoomIn raychat_noselect raychat_animated-fast" src="'+a+'" style="height: '+t+"px; margin: "+n+'px 0;"></div></div>';window.parent.document.getElementsByTagName("body")[0].insertAdjacentHTML("beforeend",i)}window.parent.document.getElementById("raychat_open_modal").style.height=_+"px",parent.window.document.body.style.overflow="hidden",window.parent.document.getElementById("raychat_open_modal").addEventListener("click",function(e){window.parent.document.getElementById("raychat_open_modal").classList.remove("active"),parent.window.document.body.style.removeProperty("overflow")})}function raychat_append_media(e,a,t,n,_){var i,o,r=!e.id,c=n?"afterbegin":"beforeend";r?i=Math.random().toString(36).substring(7):(i=e.id,e.name=e.meta.name,e.size=e.meta.size,e.accessibleSize=e.meta.accessibleSize);var m=r?widget.lang.sending:e.name,d=r?a:cdnUrl+e.message,l=!_;switch(t){case 0:var h=r?"":"?size="+e.accessibleSize;o=l?'<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_message_me raychat_main_container_body_chat_item_message_me_uploaded_image"><img class="raychat_main_container_user_uploaded_pic" onclick="raychat_open_image(this)" src="'+a+h+'"/><span class="raychat_main_container_body_chat_item_message_me_uploaded_image_status raychat_noselect">'+m+"</span></div></div>":'<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_avatar" style="background-image: '+_.avatar+' "></div><div class="raychat_main_container_body_chat_item_message_agent raychat_main_container_body_chat_item_message_agent_uploaded_image"><img class="raychat_main_container_user_uploaded_pic" onclick="raychat_open_image(this)" src="'+a+h+'"/><span class="raychat_main_container_body_chat_item_message_agent_uploaded_image_status raychat_noselect">'+m+"</span></div></div>";break;case 1:o=l?'<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated">\n        <div class="raychat_main_container_body_chat_item_message_me raychat_main_container_body_chat_item_message_me_uploaded_media"><video controls>\n            <source src="'+a+'" type="video/mp4">\n            <source src="'+a+'" type="video/ogg">\n            Your browser does not support the video tag.\n          </video><span class="raychat_main_container_body_chat_item_message_me_uploaded_image_status raychat_noselect">'+m+"</span></div></div>":'<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated">\n        <div class="raychat_main_container_body_chat_item_avatar" style="background-image: '+_.avatar+' "></div>\n        <div class="raychat_main_container_body_chat_item_message_agent raychat_main_container_body_chat_item_message_agent_uploaded_media">\n        <video controls>\n            <source src="'+a+'" type="video/mp4">\n            <source src="'+a+'" type="video/ogg">\n            Your browser does not support the video tag.\n          </video><span class="raychat_main_container_body_chat_item_message_agent_uploaded_image_status raychat_noselect">'+m+"</span></div></div>";break;case 2:o=l?'<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated">\n        <div class="raychat_main_container_body_chat_item_message_me raychat_main_container_body_chat_item_message_me_uploaded_media">\n        <audio controls style="margin-right: -15px;">\n            <source src="'+a+'" type="audio/ogg">\n            <source src="'+a+'" type="audio/mpeg">\n          Your browser does not support the audio element.\n          </audio><span class="raychat_main_container_body_chat_item_message_me_uploaded_image_status raychat_noselect">'+m+"</span></div></div>":'<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated">\n        <div class="raychat_main_container_body_chat_item_avatar" style="background-image: '+_.avatar+'"></div>\n        <div class="raychat_main_container_body_chat_item_message_agent raychat_main_container_body_chat_item_message_agent_uploaded_media">\n        <audio controls style="width: 120px; margin: 0 0 -13px -10px;">\n            <source src="'+a+'" type="audio/ogg">\n            <source src="'+a+'" type="audio/mpeg">\n          Your browser does not support the audio element.\n          </audio><span class="raychat_main_container_body_chat_item_message_agent_uploaded_image_status raychat_noselect">'+m+"</span></div></div>";break;case 3:case 4:o=l?'<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated">\n        <div class="raychat_main_container_body_chat_item_message_me raychat_main_container_body_chat_item_message_me_uploaded_media">\n\n      <div class="raychat_file_div">\n        <div class="raychat_file_icon">\n          <a target="_blank" href="'+d+'"><img src="'+webAppUrl+'/widget/images/download.png"></a>\n        </div>\n        <div class="raychat_file_name">'+e.name+'<br>\n        <span class="raychat_file_size">'+bytesToSize(e.size)+'</span>\n        </div>\n      </div>\n\n      <span class="raychat_main_container_body_chat_item_message_me_uploaded_image_status raychat_noselect">'+m+"</span></div></div>":'<div id="'+i+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated">\n        <div class="raychat_main_container_body_chat_item_avatar" style="background-image: '+_.avatar+' "></div>\n\n      <div class="raychat_main_container_body_chat_item_message_agent raychat_main_container_body_chat_item_message_agent_uploaded_media">\n\n      <div class="raychat_file_div">\n        <div class="raychat_file_icon">\n          <a target="_blank" href="'+d+'"><img src="'+webAppUrl+'/widget/images/download.png"></a>\n        </div>\n        <div class="raychat_file_name">'+e.name+'<br>\n        <span class="raychat_file_size">'+bytesToSize(e.size)+"</span>\n        </div>\n      </div>\n\n      </div></div>"}return document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML(c,o),n?s.scrollTop=n.offsetTop-22:scrollTo(s,s.scrollHeight,200),i}function raychat_upload(e,a,t){if(e){document.getElementById("raychat_main_textarea").placeholder=widget.lang.uploadingMedia;var n=raychat_append_media(e,a,t,!1),_=new FormData;_.append("uploader",raychat_local_storage.getItem("rayToken")),_.append("file",e,e.name);var i=new XMLHttpRequest;i.open("post",cdnUrl+"upload",!0),i.send(_),i.onreadystatechange=function(){if(4===i.readyState){var e=JSON.parse(i.responseText);if(e&&e.success){var a={name:e.name,size:e.size};0==t&&(a.accessibleSize=e.large?"large":"medium",e.medium||(a.accessibleSize="small")),sendMedia(e.id,t,n,a)}else document.getElementById(n).getElementsByClassName("raychat_main_container_body_chat_item_message_me_uploaded_image_status")[0].innerHTML=widget.lang.messageNotSend;document.getElementById("raychat_main_textarea").placeholder=widget.lang.sendMessage}},i.onprogress=function(e){if(e.lengthComputable){var a=e.loaded/e.total*100;document.getElementById("raychat_main_textarea").placeholder=widget.lang.uploadingMedia+" ("+a+"%)"}}}}function raychat_what_is_this_file(e){var a=e.type;return-1!=["image/webp","image/png","image/svg+xml","image/jpeg","image/gif"].indexOf(a)?0:-1!=["video/3gpp","video/ogg","video/mp4","video/mpeg","video/quicktime","video/webm","video/x-ms-wmv","video/x-msvideo"].indexOf(a)?1:-1!=["audio/mp3","audio/ogg","audio/mpeg","audio/x-m4a"].indexOf(a)?2:-1!=["application/x-zip-compressed","application/x-rar-compressed","application/zip","application/x-zip-compressed","application/x-tar","application/x-7z-compressed"].indexOf(a)?3:-1!=["application/pdf","application/vnd.ms-excel","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/rtf","application/vnd.ms-powerpoint"].indexOf(a)?4:void 0}function raychat_open_verify(a){var e=parent.window.scrollY,t=parent.window.innerHeight-100,n=window.parent.document.getElementById("raychat_open_modal");n&&n.parentNode.removeChild(n);var _,i=raychat_what_is_this_file(a),o=parent.window.innerHeight,r='\n    <div class="raychat_open_modal raychat_noselect active" id="raychat_open_modal">\n      <div>\n        <div id="raychat_modal_content" style=\'margin-top: '+e+'px\'></div>\n        <div class="raychat_btn_set">\n          <button class="raychat_btn_set_deny">\n          </button><button class="raychat_btn_set_accept"></button>\n        </div>\n\n      </div>\n    </div>';window.parent.document.getElementsByTagName("body")[0].insertAdjacentHTML("beforeend",r);var c=(o-210)/2;r='<img class="raychat_zoomIn raychat_noselect raychat_animated-fast raychat_media_loader" \n  src="'+webAppUrl+'/widget/images/widget-loader.gif" id="raychat_media_loader" style="margin-top: '+c+'px !important" >';window.parent.document.getElementById("raychat_modal_content").insertAdjacentHTML("beforeend",r);var s=window.parent.document.getElementById("raychat_media_loader"),m=parent.window.document.body.scrollHeight;switch(window.parent.document.getElementById("raychat_open_modal").style.height=m+"px",_=URL.createObjectURL(a),i){case 0:s.parentNode.removeChild(s),r='<img class="raychat_zoomIn raychat_noselect raychat_animated-fast" src="'+_+'" style="height: '+t+'px" >',window.parent.document.getElementById("raychat_modal_content").insertAdjacentHTML("beforeend",r);break;case 1:s.parentNode.removeChild(s),r="<video controls style='height:"+t+"px !important;'>\n      <source src=\""+_+'" type="video/mp4">\n      <source src="'+_+'" type="video/ogg">\n      Your browser does not support the video tag.\n    </video>',window.parent.document.getElementById("raychat_modal_content").insertAdjacentHTML("beforeend",r);break;case 2:c=(o-131)/2,s.parentNode.removeChild(s),r='<audio controls style="margin-top:'+c+'px">\n          <source src="'+_+'" type="audio/ogg">\n          <source src="'+_+'" type="audio/mpeg">\n        Your browser does not support the audio element.\n        </audio>',window.parent.document.getElementById("raychat_modal_content").insertAdjacentHTML("beforeend",r);break;case 3:s.parentNode.removeChild(s),r='<div class="raychat_file_div" style="margin-top: '+(c=(o-168)/2)+'px">\n        <div class="raychat_file_icon"><img src="'+webAppUrl+'/widget/images/Folder-Zip-icon.png"></div>\n        <div class="raychat_file_name">'+a.name+'<br>\n        <span class="raychat_file_size">'+bytesToSize(a.size)+"</span>\n        </div>\n        \n      </div>\n      ",window.parent.document.getElementById("raychat_modal_content").insertAdjacentHTML("beforeend",r);break;case 4:s.parentNode.removeChild(s),r='<div class="raychat_file_div" style="margin-top: '+(c=(o-168)/2)+'px">\n        <div class="raychat_file_icon"><img src="'+webAppUrl+'/widget/images/document-icon.png"></div>\n        <div class="raychat_file_name">'+a.name+'<br>\n        <span class="raychat_file_size">'+bytesToSize(a.size)+"</span>\n        </div>\n        \n      </div>\n      ",window.parent.document.getElementById("raychat_modal_content").insertAdjacentHTML("beforeend",r)}parent.window.pageYOffset||parent.document.documentElement.scrollTop||parent.document.body.scrollTop;parent.window.document.body.style.overflow="hidden",window.parent.document.getElementById("raychat_open_modal").addEventListener("click",function(e){e.target.className.match(/\braychat_btn_set_accept\b/)&&(raychat_upload(a,_,i),(n=window.parent.document.getElementById("raychat_open_modal"))&&n.parentNode.removeChild(n),parent.window.document.body.style.removeProperty("overflow"),a=""),e.target.className.match(/\braychat_btn_set_deny\b/)&&((n=window.parent.document.getElementById("raychat_open_modal"))&&n.parentNode.removeChild(n),parent.window.document.body.style.removeProperty("overflow"),a="")})}function bytesToSize(e){if(0==e)return"0 Byte";var a=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,a),2)+" "+["Bytes","KB","MB","GB","TB"][a]}function appendMsg(e,a,t){if(0!==e.length&&e.trim()){var n;if(a)var _=a.id||"";if(a.type)raychat_append_media(a,cdnUrl+e,parseInt(a.type),t);else{if("00raychat:data:image0"==e.substr(0,21))n='<div id="'+_+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_message_me raychat_main_container_body_chat_item_message_me_uploaded_image"><img class="raychat_main_container_user_uploaded_pic" onclick="raychat_open_image(this)" src="'+e.substring(22,e.length)+'"/><span class="raychat_main_container_body_chat_item_message_agent_status raychat_noselect"></span></div></div>',t?document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("afterbegin",n):document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",n);else if(raychat_find_urls(e)){var i=raychat_find_urls(e),o=i[0];o=raychat_concat_protocol_to_url(o),n='<div id="'+_+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_message_me raychat_bgc">'+raychat_htmlEntities(e)+'<div class="raychat_link_preview"><a href="'+o+'" target="_blank" title="'+o+'">'+raychat_extract_hostname(i[0])+'</a></div><span class="raychat_main_container_body_chat_item_message_me_status raychat_noselect"></span></div></div>',t?document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("afterbegin",n):document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",n),raychat_get_url_preview(o,_,_,a.meta.linkPreview)}else n='<div id="'+_+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_me fadeInUp  raychat_animated"> <div class="raychat_main_container_body_chat_item_message_me raychat_bgc">'+raychat_htmlEntities(e)+'<span class="raychat_main_container_body_chat_item_message_me_status raychat_noselect"></span></div></div>',t?document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("afterbegin",n):document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",n);t?s.scrollTop=t.offsetTop-22:scrollTo(s,s.scrollHeight,200),document.getElementsByClassName("raychat_main_container_body_chat_item_typing")&&document.getElementsByClassName("raychat_main_container_body_chat_item_typing").remove()}}}function appendMsgAgent(e,a,t,n,_,i,o){if(e&&0!==e.length&&e.trim()){var r,c,m=0;if(a?(c="url('"+webAppUrl+"/"+a+"');",m++):""!==document.getElementById("raychat_scripts").getAttribute("raychat_onlineAgents")&&document.getElementById("raychat_scripts").getAttribute("raychat_onlineAgents")&&(c="url('"+webAppUrl+document.getElementById("raychat_scripts").getAttribute("raychat_onlineAgents")+"')",m++),0==m&&(c="url('"+webAppUrl+"/"+raychat_local_storage.getItem("raychat_channel_photo")+"')"),i&&i.type){var d={avatar:c};raychat_append_media(i,cdnUrl+e,parseInt(i.type),o,d)}else{var l=n||"";if("00raychat:data:image0"==e.substr(0,21))r='<div id="'+l+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_avatar" style="background-image: '+c+' "></div><div class="raychat_main_container_body_chat_item_message_agent raychat_main_container_body_chat_item_message_agent_uploaded_image"><img class="raychat_main_container_user_uploaded_pic" onclick="raychat_open_image(this)" src="'+webAppUrl+"/"+e.substring(22,e.length)+'"/><span class="raychat_main_container_body_chat_item_message_agent_status raychat_noselect"></span></div></div>',o?document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("afterbegin",r):document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",r);else if(raychat_find_urls(e)){var h=raychat_find_urls(e),y=h[0];y=raychat_concat_protocol_to_url(y),r='<div id="'+l+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_avatar" style="background-image:'+c+' "></div><div class="raychat_main_container_body_chat_item_message_agent">'+raychat_htmlEntities(e)+'<div class="raychat_link_preview"><a href="'+y+'" target="_blank" title="'+y+'">'+raychat_extract_hostname(h[0])+'</a></div><span class="raychat_main_container_body_chat_item_message_agent_status raychat_noselect"></span></div></div>',o?document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("afterbegin",r):document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",r),_?raychat_get_url_preview(y,l,l):i&&i.meta&&raychat_get_url_preview(y,l,l,i.meta.linkPreview)}else r='<div id="'+l+'" class="raychat_main_container_body_chat_item raychat_main_container_body_chat_agent fadeInUp raychat_animated"><div class="raychat_main_container_body_chat_item_avatar" style="background-image:'+c+' "></div><div class="raychat_main_container_body_chat_item_message_agent">'+raychat_htmlEntities(e)+'<span class="raychat_main_container_body_chat_item_message_agent_status raychat_noselect"></span></div></div>',o?document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("afterbegin",r):document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",r);o?s.scrollTop=o.offsetTop-22:scrollTo(s,s.scrollHeight,200),document.getElementsByClassName("raychat_main_container_body_chat_item_typing")&&document.getElementsByClassName("raychat_main_container_body_chat_item_typing").remove()}}}function raychat_user_me_message_count(){return document.getElementsByClassName("raychat_main_container_body_chat_item_message_me").length}function scrollTo(e,a,t){if(!(t<=0)){var n=(a-e.scrollTop)/t*10;setTimeout(function(){e.scrollTop=e.scrollTop+n,e.scrollTop!==a&&scrollTo(e,a,t-10)},10)}}function raychat_open_emoji_list(e){openedEmoji?(q.classList.remove("active"),e.classList.remove("active"),openedEmoji=!1):(q.className+=" active",e.className+=" active",openedEmoji=!0)}function raychat_new_emoji(e){0==document.getElementById("raychat_main_textarea").value?snd(e.innerHTML,!0):document.getElementById("raychat_main_textarea").value+=e.innerHTML,i.focus(),0!=i.value.length?h.className.match(/\bactive\b/)||(h.className+=" active"):h.classList.remove("active")}function raychat_agent_accept(e){n=e.avatar;var a,t=e.name,_=!1;(null==raychat_local_storage.getItem("raychat_agent_name")&&(_=!0),raychat_local_storage.setItem("raychat_agent_avatar",n),raychat_local_storage.setItem("raychat_agent_name",t),raychat_local_storage.setItem("raychat_agent_title",e.title),raychat_local_storage.setItem("raychat_agent_id",e.id),raychat_local_storage.setItem("raychat_conversationId",e.conversationId),_)&&(a='<div class="raychat_main_container_body_chat_item_toast_message raychat_zoomIn raychat_animated active raychat_noselect" id="raychat_main_container_body_chat_item_toast_message">'+e.name+" "+widget.lang.acceptConversationWithYou+"</div>",document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",a));l.classList.remove("active"),o.className+=" active",x.getElementsByTagName("h3")[0].innerHTML=t,x.getElementsByTagName("p")[0].innerHTML=e.title||"",x.getElementsByClassName("raychat_main_container_header_agents_1")[0].style.backgroundImage="url('"+webAppUrl+e.avatar+"')",scrollTo(s,s.scrollHeight,200)}function raychat_agent_transfer(e){n=e.targetAgentAvatar;var a,t=e.targetAgentName;raychat_local_storage.setItem("raychat_agent_avatar",n),raychat_local_storage.setItem("raychat_agent_name",t),raychat_local_storage.setItem("raychat_agent_title",e.targetAgentTitle),raychat_local_storage.setItem("raychat_agent_id",e.targetAgentId),raychat_local_storage.setItem("raychat_conversationId",e.conversationId),a='<div class="raychat_main_container_body_chat_item_toast_message raychat_zoomIn raychat_animated active raychat_noselect" id="raychat_main_container_body_chat_item_toast_message">'+widget.lang.transferConversation+e.targetAgentName+"</div>",document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",a),l.classList.remove("active"),o.className+=" active";for(var _=document.getElementsByClassName("raychat_main_container_body_chat_item_avatar"),i=0;i<_.length;i++);x.getElementsByTagName("h3")[0].innerHTML=t,x.getElementsByTagName("p")[0].innerHTML=e.title||"",x.getElementsByClassName("raychat_main_container_header_agents_1")[0].style.backgroundImage="url('"+webAppUrl+e.targetAgentAvatar+"')",scrollTo(s,s.scrollHeight,200)}function raychat_conversationClosed(e){var a;(raychat_local_storage.remove("raychat_agent_avatar"),raychat_local_storage.remove("raychat_agent_name"),raychat_local_storage.remove("raychat_agent_title"),raychat_local_storage.remove("raychat_agent_id"),raychat_local_storage.remove("raychat_conversationId"),e)||(a='<div class="raychat_main_container_body_chat_item_toast_message raychat_zoomIn raychat_animated active raychat_noselect" id="raychat_main_container_body_chat_item_toast_message">'+widget.lang.conversationClosed+"</div>",document.getElementById("raychat_main_container_body_chat").insertAdjacentHTML("beforeend",a),scrollTo(s,s.scrollHeight,200));o.classList.remove("active"),l.className+=" active",raychat_getAgents()}function raychat_toggle_spinner(e){e?m.className+=" active":m.classList.remove("active")}function raychatCloseClicked(){window.parent.document.getElementById("raychatBtn").click()}function raychat_reset_counter(){counter=0}function raychat_validate_email(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function raychat_setUser(e){e.id=raychat_local_storage.getItem("rayToken"),io.socket.post(webAppUrl+"/socket/userDetail",e,function(e){e.success&&e.user&&(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val")&&(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").value=e.user.email),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val")&&(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").value=e.user.phone||""),parent.Raychat.__profile_updated(e.user))})}function raychat_load_user(e){e&&tdata.id!=e&&raychat_floating_app_widget_init({load:!0,userId:e})}function raychat_unload_user(){raychat_local_storage.removeAll(),localStorage.removeItem("rayToken"),io.socket.disconnect(),delete tdata.id}function raychat_send_email_add(t){if(delete tdata.tmpId,delete tdata.href,delete tdata.msg,tdata.id=raychat_local_storage.getItem("rayToken"),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").value){if(!raychat_validate_email(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").value))return document.getElementById("raychat_user_more_details_response_email").className+=" error",document.getElementById("raychat_user_more_details_response_email").classList.remove("success"),document.getElementById("raychat_user_more_details_response_email").innerHTML=widget.lang.invalidEmail,!1;tdata.email=document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").value}document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").value&&(tdata.phone=document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").value);var e=document.getElementsByClassName("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab"),a=[];if(e[0]){e=e[0].getElementsByTagName("li");for(var n=0;n<=e.length;n++)if(e[n]&&e[n].id){var _=e[n].id.split("_");a.push(_[_.length-1])}}tdata.shownField=a,io.socket.post(webAppUrl+"/socket/userDetail",tdata,function(e){if(e.success)e.user.lockForFillDetails||(raychat_avoid_sending(!1),document.getElementsByClassName("raychat_main_container_footer")[0].removeEventListener("click",scroll_to_form,!0),document.getElementById("raychat_main_textarea").disabled=!1,document.getElementById("raychat_main_textarea").placeholder=widget.lang.sendMessage,document.getElementById("raychat_main_textarea").focus(),scrollTo(s,s.scrollHeight,2e3)),isUserLock=e.user.lockForFillDetails,e.neededField&&("phone"===e.neededField?simulatedClick(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_phone")):simulatedClick(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab_email"))),document.getElementById("raychat_user_more_details_response_email")&&(document.getElementById("raychat_user_more_details_response_email").className+=" success",document.getElementById("raychat_user_more_details_response_email").classList.remove("error")),document.getElementById("raychat_user_more_details_response_phone")&&(document.getElementById("raychat_user_more_details_response_phone").className+=" success",document.getElementById("raychat_user_more_details_response_phone").classList.remove("error")),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").value&&(document.getElementById("raychat_user_more_details_response_email").innerHTML=widget.lang.yourDetailsWasSaved,document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").disabled=!0,t.disabled=!0),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val")&&document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").value&&(document.getElementById("raychat_user_more_details_response_phone").innerHTML=widget.lang.yourDetailsWasSaved,document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").disabled=!0,t.disabled=!0),parent.Raychat.__profile_updated(e.user);else{document.getElementById("raychat_user_more_details_response_email").className+=" error",document.getElementById("raychat_user_more_details_response_email").classList.remove("success"),document.getElementById("raychat_user_more_details_response_phone").className+=" error",document.getElementById("raychat_user_more_details_response_phone").classList.remove("success");var a=e.data.invalidAttributes;a&&(document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").value&&("unique"==a.email[0].rule?document.getElementById("raychat_user_more_details_response_email").innerHTML=widget.lang.emailAlreadyExist:document.getElementById("raychat_user_more_details_response_email").innerHTML=widget.lang.invalidEmail),document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").value&&(document.getElementById("raychat_user_more_details_response_email").innerHTML=widget.lang.thereWas))}})}function closeAutomessage(e){tdata.id=localStorage.getItem("rayToken"),io.socket.post(webAppUrl+"/socket/automessage",{action:"close",autoMessageId:e,data:tdata},function(e,a){console.log(e),console.log(a)})}function simulatedClick(e,a){var t=e.ownerDocument.createEvent("MouseEvents"),n=(a=a||{},{type:"click",canBubble:!0,cancelable:!0,view:e.ownerDocument.defaultView,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null});for(var _ in a)a.hasOwnProperty(_)&&(n[_]=a[_]);t.initMouseEvent(n.type,n.canBubble,n.cancelable,n.view,n.detail,n.screenX,n.screenY,n.clientX,n.clientY,n.ctrlKey,n.altKey,n.shiftKey,n.metaKey,n.button,n.relatedTarget),e.dispatchEvent(t)}function scroll_to_form(){var e=document.getElementsByClassName("raychat_main_container_body_chat_item_message_agent_email_phone_form_tab")[0].getElementsByClassName("active")[0].getAttribute("id").split("_");e&&0<e.length&&("phone"===e[e.length-1]?document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_phone_val").focus():document.getElementById("raychat_main_container_body_chat_item_message_agent_email_phone_form_body_email_val").focus());scrollTo(s,s.scrollHeight-document.getElementsByClassName("raychat_main_container_body_chat_item_message_agent_email_phone_form")[0].offsetHeight-280,300)}tdata.href=window.location.href,raychat_local_storage.getItem("rayToken")&&(tdata.id=raychat_local_storage.getItem("rayToken")),Array.prototype.move=function(e,a){"[object Array]"===Object.prototype.toString.call(this)&&e&&"number"==typeof e&&a&&"number"==typeof a&&(a>this.length&&(a=this.length),this.splice(a,0,this.splice(e,1)[0]))},document.getElementById("raychat_main_textarea").onkeyup=function(e){var a=document.getElementById("raychat_main_textarea").value,t=a.substr(a.length-1),n=a.substr(a.length-2,1);" "==n&&32==e.keyCode||(32==e.keyCode||8==e.keyCode&&" "==t&&" "!=n)&&io.socket.post(webAppUrl+"/socket/real",tdata,function(e){})};